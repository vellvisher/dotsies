;; Add melpa package repository.
(require 'package)
(add-to-list 'package-archives
             '("melpa" . "http://melpa.milkbox.net/packages/") t)
(package-initialize)

;; Show trailing whitespace.
(setq-default show-trailing-whitespace t)

;; Find files in repository (install from melpa).
;; From https://github.com/hoffstaetter/find-file-in-repository
(require 'find-file-in-repository)
(global-set-key (kbd "C-x f") 'find-file-in-repository)

;; Hide toolbar.
(tool-bar-mode -1)

;; Hide menu bar.
(menu-bar-mode -1)

;; Prevent Extraneous Tabs.
;; From http://www.gnu.org/software/emacs/manual/html_node/eintr/Indent-Tabs-Mode.html
(setq-default indent-tabs-mode nil)

;; Electric pair mode.
;; Automatically closes brackets.
(electric-pair-mode)

;; Start emacs daemon
(server-start)

;; Partially use path in buffer name.
(setq uniquify-buffer-name-style 'forward)

;; Get rid of splash screens.
;; From http://www.emacswiki.org/emacs/EmacsNiftyTricks
(setq inhibit-splash-screen t)

;; Enabling subword mode (ie. navigate cameCase)
;; From http://www.emacswiki.org/emacs/CamelCase
(subword-mode t)

;; Display line numbers.
(linum-mode t)

;; Display column numbers.
(column-number-mode t)

;; Load molokai theme.
;; From https://github.com/alloy-d/color-theme-molokai
;; Requires: color-theme (install from melpa).
(require 'color-theme)
(load "~/.emacs.d/downloads/molokai/color-theme-molokai.el")
(color-theme-molokai)

;; 100-column limit for java.
(add-hook 'java-mode-hook
          (lambda ()
            (set-fill-column 100)))
;; 2-char indent for java.
(add-hook 'java-mode-hook (lambda ()
                            (setq c-basic-offset 2)))

;; New browser tab.
(cond
 ((string-equal system-type "darwin") ; Mac OS X
    (defun new-browser-tab ()
      "Open a new browser tab in the default browser."
      (interactive)
      (shell-command "open http://google.com")
      ))
 ((string-equal system-type "gnu/linux") ; Linux
    (defun new-browser-tab ()
      "Open a new browser tab in the default browser."
      (interactive)
      (shell-command "google-chrome http://google.com")
      ))
 )
(global-set-key (kbd "C-x t") 'new-browser-tab)

;; Interactively do things.
(ido-mode t)
;; Remember buffers even if closed.
'(ido-use-virtual-buffers t)

;; Disable backup.
;; From: http://anirudhsasikumar.net/blog/2005.01.21.html
(setq backup-inhibited t)

;; Disable auto save.
;; From: http://anirudhsasikumar.net/blog/2005.01.21.html
(setq auto-save-default nil)

;; Case-sensitive fold search search (ie. M-/ to autocomplete).
(setq dabbrev-case-fold-search nil)

;; Rename file and buffer.
;; From: https://sites.google.com/site/steveyegge2/my-dot-emacs-file
(defun rename-file-and-buffer (new-name)
  "Renames both current buffer and file it's visiting to NEW-NAME." (interactive "sNew name: ")
  (let ((name (buffer-name))
        (filename (buffer-file-name)))
    (if (not filename)
        (message "Buffer '%s' is not visiting a file!" name)
      (if (get-buffer new-name)
          (message "A buffer named '%s' already exists!" new-name)
        (progn  (rename-file name new-name 1)  (rename-buffer new-name)  (set-visited-file-name new-name)  (set-buffer-modified-p nil)))))) ;;

;; Move buffer file.
;; From: https://sites.google.com/site/steveyegge2/my-dot-emacs-file
(defun move-buffer-file (dir)
  "Moves both current buffer and file it's visiting to DIR." (interactive "DNew directory: ")
  (let* ((name (buffer-name))
         (filename (buffer-file-name))
         (dir
          (if (string-match dir "\\(?:/\\|\\\\)$")
              (substring dir 0 -1) dir))
         (newname (concat dir "/" name)))

    (if (not filename)
        (message "Buffer '%s' is not visiting a file!" name)
      (progn (copy-file filename newname 1) (delete-file filename) (set-visited-file-name newname) (set-buffer-modified-p nil) t))))
